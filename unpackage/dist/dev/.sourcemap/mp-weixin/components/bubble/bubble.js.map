{"version":3,"sources":["webpack:////Users/lisicheng/project/lijian/components/bubble/bubble.vue?8380","webpack:////Users/lisicheng/project/lijian/components/bubble/bubble.vue?ae18","webpack:////Users/lisicheng/project/lijian/components/bubble/bubble.vue?e0d2","webpack:////Users/lisicheng/project/lijian/components/bubble/bubble.vue?aad8","uni-app:///components/bubble/bubble.vue","webpack:////Users/lisicheng/project/lijian/components/bubble/bubble.vue?7ae5","webpack:////Users/lisicheng/project/lijian/components/bubble/bubble.vue?d5ad"],"names":["props","page","type","discharge","default","top","left","updateTime","data","index","list","currentList","status","pages","timer","showBubble","watch","handler","Cache","clearTimeout","immediate","clearInterval","computed","isOpen","methods","$getBubbleLists","res","requestTime","fadeUpBubble","currentTime","created","bubble","onLoad","destroyed"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;AACc;;;AAGnE;AAC6M;AAC7M,gBAAgB,iNAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAqzB,CAAgB,oyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACqBz0B;AACA;;;;;;;;;;;;;;;;;;;;;eACA;EACAA;IACA;IACAC;MACAC;IACA;IACA;IACAC;MACAD;MACAE;IACA;IACAC;MACAH;MACAE;IACA;IACAE;MACAJ;MACAE;IACA;IACAG;MACAL;MACAE;IACA;EACA;EACAI;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAP;MACAQ;QAAA;QACA;QACA;UACA;UACA;YACA;YACAC;YACA;YACAC;UACA;QACA;UACA;UACA;QACA;MACA;MACAC;IACA;IACAjB;MACA;MACA;QACA;QACAe;QACAG;QACA;QACA;MACA;QACA;MACA;IACA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;cAAA;gBAAAC;gBACA;gBACA;gBACA;gBACAC;gBACAT;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAGA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACAU;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAD;gBACAE;gBACA;gBAAA,MACAA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;cAAA;gBACAX;cAAA;gBAEA;kBACAG;kBACA;gBACA;gBAEA;gBACA;kBACAH;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;EACA;EACAY;IAAA;IAAA;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cACA;cACArB;cAAA;cAAA,OACA;YAAA;cAAAsB;cACA;cACA;cACA;cACA;gBACAb;gBACA;cACA;gBACAA;gBACA;cACA;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EACA;EACAc;EACAC;IACA;MACAZ;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;ACxJA;AAAA;AAAA;AAAA;AAAwgD,CAAgB,m6CAAG,EAAC,C;;;;;;;;;;;ACA5hD;AACA,kBAAkB;AAClB,OAAO,KAAU,EAAE,kBAKd","file":"components/bubble/bubble.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./bubble.vue?vue&type=template&id=03e09ac4&\"\nvar renderjs\nimport script from \"./bubble.vue?vue&type=script&lang=js&\"\nexport * from \"./bubble.vue?vue&type=script&lang=js&\"\nimport style0 from \"./bubble.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/bubble/bubble.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bubble.vue?vue&type=template&id=03e09ac4&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bubble.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bubble.vue?vue&type=script&lang=js&\"","<template>\n    <view\n        v-if=\"isOpen\"\n        class=\"bubble-tips-container\"\n        :style=\"{ top: top, left: left }\"\n    >\n        <view\n            class=\"bubble-content flex\"\n            v-show=\"showBubble\"\n            v-for=\"(item, index) in currentList\"\n            :key=\"index\"\n        >\n            <image class=\"bubble-img\" :src=\"item.avatar\" />\n            <view class=\"xs\">\n                {{ item.content }}\n            </view>\n        </view>\n    </view>\n</template>\n\n<script>\nimport { apiFootprint } from \"@/api/store\";\nimport Cache from \"@/utils/cache\";\nexport default {\n    props: {\n        //1-首页， 2-商品详情\n        page: {\n            type: Number,\n        },\n        // 是否停止切换\n        discharge: {\n            type: Boolean,\n            default: false,\n        },\n        top: {\n            type: String,\n            default: \"40rpx\",\n        },\n        left: {\n            type: String,\n            default: \"20rpx\",\n        },\n        updateTime: {\n            type: Number,\n            default: 2 * 60 * 1000,\n        },\n    },\n    data() {\n        return {\n            index: Cache.get(this.indexKey) || 0,\n            list: [],\n            currentList: [],\n            status: 0,\n            pages: [],\n            timer: null,\n            showBubble: false,\n        };\n    },\n    watch: {\n        index: {\n            handler(newValue, oldValue) {\n                if (this.list.length == 0) return;\n                if (this.index - this.list.length > 0) {\n                    this.showBubble = false;\n                    let timer = setTimeout(() => {\n                        this.index = 0;\n                        Cache.set(this.indexKey, 0);\n                        this.fadeUpBubble();\n                        clearTimeout(timer);\n                    }, 500);\n                } else {\n                    this.fadeUpBubble();\n                    return;\n                }\n            },\n            immediate: true,\n        },\n        discharge() {\n            // 为了让活性的页面停止计时器\n            if (this.discharge) {\n                // 停止\n                Cache.set(this.indexKey, this.index);\n                clearInterval(this.timer);\n                this.timer = null;\n                return false;\n            } else {\n                this.fadeUpBubble();\n            }\n        },\n    },\n    computed: {\n        isOpen() {\n            return this.status && this.pages.includes(this.page);\n        },\n    },\n    methods: {\n        async $getBubbleLists() {\n            const res = await apiFootprint();\n            this.list = res.lists;\n            this.status = res.status;\n            this.pages = res.pages;\n            var requestTime = new Date().getTime();\n            Cache.set(this.requestKey, requestTime);\n            if (!this.isOpen) {\n                return;\n            }\n            this.fadeUpBubble();\n        },\n        async fadeUpBubble() {\n            let requestTime = Cache.get(this.requestKey);\n            let currentTime = new Date();\n            this.showBubble = true;\n            if (currentTime.getTime() - requestTime >= this.updateTime) {\n                await this.$getBubbleLists();\n                Cache.set(this.indexKey, 0);\n            }\n            if (this.timer) {\n                clearInterval(this.timer);\n                this.timer = null;\n            }\n\n            this.currentList = this.list.slice(this.index, this.index + 1);\n            this.timer = setInterval(() => {\n                Cache.set(this.indexKey, ++this.index);\n            }, 3000);\n        },\n    },\n    async created() {\n        this.indexKey = \"currentIndex\" + this.page;\n        this.requestKey = \"requestTime\" + this.page;\n        var index = Cache.get(this.indexKey) || 0;\n        var bubble = await apiFootprint();\n        this.list = bubble?.lists || [];\n        this.status = bubble?.status || 0;\n        this.pages = bubble?.pages || [];\n        if (this.list.length <= 0) {\n            Cache.set(this.indexKey, 0);\n            this.fadeUpBubble();\n        } else if (index - this.list.length >= 0) {\n            Cache.set(this.indexKey, 0);\n            this.fadeUpBubble();\n        } else {\n            this.fadeUpBubble();\n        }\n    },\n    onLoad() {},\n    destroyed() {\n        if (this.timer) {\n            clearInterval(this.timer);\n            this.timer = null;\n        }\n    },\n};\n</script>\n\n<style lang=\"scss\">\n.bubble-tips-container {\n    position: absolute;\n    z-index: 900;\n\n    .bubble-content {\n        padding: 4rpx 20rpx 4rpx 10rpx;\n        background-color: rgba(0, 0, 0, 0.6);\n        color: white;\n        border-radius: 120rpx;\n\n        .bubble-img {\n            width: 50rpx;\n            height: 50rpx;\n            border-radius: 50%;\n            margin-right: 10rpx;\n        }\n    }\n}\n</style>\n","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bubble.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bubble.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"red_theme\":\"#FF2C3C\",\"orange_theme\":\"#f7971e\",\"pink_theme\":\"#fa444d\",\"gold_theme\":\"#e0a356\",\"blue_theme\":\"#2f80ed\",\"green_theme\":\"#2ec840\"};\n    if(module.hot) {\n      // 1734252386422\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":true});\n      module.hot.dispose(cssReload);\n      \n    }\n  "],"sourceRoot":""}