(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["uni_modules/c-3d-model/components/c-3d-model/c-3d-model"],{"33a0":function(e,t,n){},"491e":function(e,t,n){"use strict";n.r(t);var o=n("6a2c"),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},5422:function(e,t,n){"use strict";n.r(t);var o=n("f410"),i=n("491e");for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("fa18");var r=n("828b"),s=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"5703c019",null,!1,o["a"],void 0);t["default"]=s.exports},"6a2c":function(e,t,n){"use strict";(function(e){var o=n("47a9"),i=n("3b2d");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("7eb4")),r=o(n("af34")),s=o(n("ee10")),l=o(n("9b35")),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var s=a?Object.getOwnPropertyDescriptor(e,r):null;s&&(s.get||s.set)?Object.defineProperty(o,r,s):o[r]=e[r]}o.default=e,n&&n.set(e,o);return o}(n("9d07")),d=n("5346"),u=n("57f8"),f=n("d522"),p=n("b5cd"),h=n("b5bf");function m(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}var v,g,y,b,w,R,S,x,P,O,L=!1,M={props:{canvasId:{type:String},width:{type:String,default:"750rpx"},height:{type:String,default:"750rpx"},decoderPath:{type:String,default:""},src:{type:String},environmentSrc:{type:String},ambientLight:{type:Number,default:.5},modelScale:{type:Array,default:function(){return[1,1,1]}},modelRotate:{type:Array,default:function(){return[0,0,0]}},modelPosition:{type:Array,default:function(){return[0,0,0]}},autoPlay:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!1},isCenter:{type:Boolean,default:!1}},emits:["loaded"],data:function(){return{fun:{}}},computed:{myCanvasId:function(){return this.canvasId?this.canvasId:"c"+(0,l.default)(18)},modelData:function(){return{myCanvasId:this.myCanvasId,width:this.width,height:this.height,decoderPath:this.decoderPath,src:this.src,environmentSrc:this.environmentSrc,ambientLight:this.ambientLight,modelScale:this.modelScale,modelRotate:this.modelRotate,modelPosition:this.modelPosition,autoPlay:this.autoPlay,autoRotate:this.autoRotate,isCenter:this.isCenter}}},watch:{modelData:function(){this.init()}},methods:{disposeScene:function(e){e.traverse((function(e){e instanceof c.Mesh&&(e.geometry.dispose(),e.material.dispose()),e instanceof c.Texture&&e.dispose()}))},removeObjects:function(e){e.traverse((function(e){e.parent&&e.parent.remove(e)}))},removeFromRenderer:function(e,t){e.renderLists.dispose(),e.renderLists.freeMemory(),e.render(t,null,0),e.renderLists.init(),e.renderLists.push(t,null,0)},call:function(e,t){if(this.fun={name:e,args:t},"play"==e||"stop"==e){var n=S.length;0==n?console.error("模型文件中无剪辑动画"):t>n?console.error("模型文件中无该剪辑动画，动画组数：",n):R.clipAction(S[t])[e]()}if("dispose"==e){x&&this.deleteObject(x),g&&(this.disposeScene(g),this.removeObjects(g));for(var o=g.children.length-1;o>=0;o--)g.remove(g.children[o]);c.PLATFORM.dispose(),g.clear(),y.dispose(),y.forceContextLoss(),y.content=null,O.cancelAnimationFrame(this.animationID),v=null,g=null,y=null,b=null,w=null,R=null,S=null,L=!1,x=null,P=null,O=null,null,console.log("场景销毁")}},playAnimation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.call("play",e)},stopAnimation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.call("stop",e)},getContext:function(){var t=this;return new Promise((function(n){var o=e.getSystemInfoSync(),i=o.pixelRatio;e.createSelectorQuery().in(t).select("#".concat(t.myCanvasId)).fields({node:!0,size:!0}).exec((function(e){var t=e[0],o=t.width,a=t.height,r=e[0].node;n({canvas:r,width:o,height:a,pixelRatio:i})}))}))},init:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var n,o,i,r,s,l;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(L=e.oldSrc!=e.src||!x,e.oldSrc=e.src,g){t.next=34;break}return t.next=5,e.getContext();case 5:n=t.sent,o=n.canvas,i=n.width,r=n.height,s=n.pixelRatio,l=new d.WechatPlatform(o),c.PLATFORM.set(l),e.platform=l,O=o,g=new c.Scene,v=new c.PerspectiveCamera(45,i/r,.25,20),v.position.set(0,.4,.7),y=new c.WebGLRenderer({alpha:!0,antialias:!0,precision:"highp",logarithmicDepthBuffer:!1}),y.setPixelRatio(.5*s),y.setSize(i,r),y.toneMapping=c.ACESFilmicToneMapping,y.toneMappingExposure=1,y.outputEncoding=c.sRGBEncoding,b=new p.OrbitControls(v,y.domElement),b.enableDamping=!0,b.minDistance=.1,b.maxDistance=1,b.autoRotate=e.autoRotate,b.target.set(0,.1,0),b.update(),e.onWindowResize(),e.animate(),t.next=35;break;case 34:e.onWindowResize();case 35:w=new c.Clock,b&&(b.autoRotate=e.autoRotate),e.light(),e.loadEnvironment(),e.loadModel();case 40:case"end":return t.stop()}}),t)})))()},onWindowResize:function(){v.aspect=parseInt(this.width)/parseInt(this.height),v.updateProjectionMatrix(),y.setSize(parseInt(this.width),parseInt(this.height))},animate:function(){this.animationID=O.requestAnimationFrame(this.animate),R&&R.update(w.getDelta()),b.update(),this.render()},render:function(){y.render(g,v)},light:function(){var e=this.modelData;e.ambientLight&&(P?P.intensity=e.ambientLight:(P=new c.AmbientLight(16777215,e.ambientLight),g.add(P)))},loadEnvironment:function(){var e=this.modelData;e.environmentSrc&&(new u.RGBELoader).load(e.environmentSrc,(function(e){e.mapping=c.EquirectangularReflectionMapping,g.background=e,g.environment=e}))},deleteObject:function(e){e.traverse((function(e){"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose())})),g.remove(e)},center:function(e){var t=new c.Box3;t.expandByObject(e);var n=new c.Vector3;t.getCenter(n),e.position.x=e.position.x-n.x,e.position.y=e.position.y-n.y,e.position.z=e.position.z-n.z},loadModel:function(){var e,t,n=this,o=this.modelData;L?(x&&this.deleteObject(x),(new f.GLTFLoader).setDRACOLoader((new h.DRACOLoader).setDecoderPath(o.decoderPath)).load(o.src,(function(e){var t,i;x=e.scene,(t=x.scale).set.apply(t,(0,r.default)(o.modelScale)),x.rotateX(o.modelRotate[0]),x.rotateY(o.modelRotate[1]),x.rotateZ(o.modelRotate[2]),o.isCenter?n.center(x):(i=x.position).set.apply(i,(0,r.default)(o.modelPosition)),R=new c.AnimationMixer(x),o.autoPlay&&(S=e.animations,S.length>0&&R.clipAction(S[0]).play()),g.add(x),n.$emit("loaded")}))):((e=x.scale).set.apply(e,(0,r.default)(o.modelScale)),x.rotateX(o.modelRotate[0]),x.rotateY(o.modelRotate[1]),x.rotateZ(o.modelRotate[2]),(t=x.position).set.apply(t,(0,r.default)(o.modelPosition)))},touchStart:function(e){this.platform.dispatchTouchEvent(e)},touchMove:function(e){this.platform.dispatchTouchEvent(e)},touchEnd:function(e){this.platform.dispatchTouchEvent(e)}},mounted:function(){this.init()},destroyed:function(){},beforeDestroy:function(){this.call("dispose")}};t.default=M}).call(this,n("df3c")["default"])},f410:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var o=function(){var e=this.$createElement;this._self._c},i=[]},fa18:function(e,t,n){"use strict";var o=n("33a0"),i=n.n(o);i.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'uni_modules/c-3d-model/components/c-3d-model/c-3d-model-create-component',
    {
        'uni_modules/c-3d-model/components/c-3d-model/c-3d-model-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('df3c')['createComponent'](__webpack_require__("5422"))
        })
    },
    [['uni_modules/c-3d-model/components/c-3d-model/c-3d-model-create-component']]
]);
